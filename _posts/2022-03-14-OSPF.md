# OSPF


It can discover neighbors, perform reliable flooding to tranfer the information, compute the shortest path to arbitrary router, and detect new changes in the system.
The networking system on OSPF is dynamic.

It's working on IP layer(Protocal Number 89).

# Some Concepts
**LSP**: Link State Pakcage
**LSA**: Link State Advertisement, has 7 types
**ABR**: Area Border Router


# Areas

Type1:

This type of LSA is used to Inform other routers in current area, would attach routers connected to the sender and lists the IP and the matric.

Type2:




Type3:

LSA's type 1(Router LSA) and 2(Network LSA) can't be used to transfer information from area to area. Generally, we use LSA type3 Network Summary LSA to inform routers out of current area. 



# Passitive Interface


# LSP

Link State Pakcage. It's used to exchange the information between the routers. There are five types of packages.

Header indicates the version, type, length, router ID, Area ID, Checksum, AuType(Authentication type), and Authentication.

OSPF2 is for Ipv4 and OSPF3 is for Ipv6. LSP has 5 types, including "Hello", "DD", "LSR", "LSU", and "LSAck". The "router ID" in the header indicate the IP of src router. Checksum is the checksum of the entire package expcept the aunthentication. 


Hello, type 1, includes some basic information, such as the DR&BDR's IP addresses, Area ID, and Hello&Dead intervals.

And OSPF has 4 types of update packets as fowllowing, in high level, the procedure is
- Dsicover neighbor
- Establish bidirectional communication
- Elect a DR
- Form an adjacency
- Discover the network routes
- update and synchronize link-state databases

DBD(Database Description), LSR(Link State Request), LSU(Link State Update), LSAck(Link State Acknowledgment).

If a router detacts some changes, it would use LSU to inform others by multicasst in order to syncronize all the routers.  

# Router's state

- down, no active neighbors
- init, got a hello package
- two-way, own router id in receieve hello(got response)
- Exstart, master and slave roles determinded
- Exchange, sent DBD
- Loading, LSR+LSU
- FUll, syncronized

# Reliable flooding

# Unicast, Multicast, Broadcast

Unicast is the base of point2point communication and using broadcast could send message to all the hosts in a broadcast domain while multicast could send packages to a group of hosts. Mutilcast has some advantages, such as it only duplicates the meesge when in need and provides efficient control of a group of hosts.

Multicast uses Class D IP address space. "Could a switch recognize the IP? and only sends the packages to the hosts in a specific group?" Obiviously, the answer is no, the switch works on layer two and it even doesn't know what's the "IP". Actually, similar to the broadcast MAC address, we have special reserved MAC addresses for multicast. And the switch would defaultly forwaord the multicast packets to all the out ports. And IGMP is used to eliminate the unecessary flooding.


Similar for IP, we also reserve some addresses for multicast. 224.0.0.0 - 239.255.255.255, more specifically 224.0.0.0 - 224.0.0.255 are for routing protocols. And there are some very important addresses for the OSPF.

- 224.0.0.1 -> all the hosts on subnet
- 225.0.0.2 -> all the routers on subnet
- 224.0.0.5 -> all routers on subnet who run OSPF
- 224.0.0.22 -> IGMP Traffic



> OUI is the first 3 bytes of a mac address, for example, 11:22:33:44:55:66's OUI is 11:22:33.